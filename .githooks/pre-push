#!/bin/sh
# Pre-push hook to prevent direct pushes to main
# All work must go through the current version branch (e.g., 0.3.x)

while read local_ref local_sha remote_ref remote_sha; do
    if [ "$remote_ref" = "refs/heads/main" ]; then
        echo ""
        echo "â›” Direct pushes to main are blocked!"
        echo ""
        echo "ALL work goes through the version branch:"
        echo ""
        echo "  1. Find current version branch:"
        echo "     git branch -r | grep -E 'origin/[0-9]+\.[0-9]+\.x$'"
        echo ""
        echo "  2. Branch from it:"
        echo "     git checkout 0.X.x && git checkout -b feat/your-feature"
        echo ""
        echo "  3. PR targets the version branch, not main"
        echo ""
        echo "ðŸ“– See CONTRIBUTING.md for full workflow"
        echo ""
        exit 1
    fi
done

exit 0
